import { a } from './chunk-2ZHY67WV.js';
import { m as m$1, p, r, t, s, q, n as n$1 } from './chunk-M2K4SFTP.js';
import './chunk-SUQRZR4A.js';
import { n, l, d, m as m$2, c, g as g$1, h as h$1 } from './chunk-UCAKPZG2.js';
import { j as j$1, h, e, F, k as k$1, x } from './chunk-V5V6QK5E.js';

new URL(import.meta.url).pathname; 
j$1();h();j$1();h();n();var m=e(a(),1),ue=e(m$1(),1);l();d();j$1();h();var I=e(a(),1),te=(n,e,t)=>Math.min(Math.max(n,e),t);function ne(n,e,t=U(e)){n=te(n,0,e.length);let i=0,o=t.length;if(o===0)return I.Position.create(0,n);for(;i<=o;){let D=Math.floor((i+o)/2),P=t[D];if(P===n)return I.Position.create(D,0);n>P?i=D+1:o=D-1;}let c=i-1;return I.Position.create(c,n-t[c])}function O(n,e,t=U(e)){if(n.line>=t.length)return e.length;if(n.line<0)return 0;let i=t[n.line],o=n.line+1<t.length?t[n.line+1]:e.length;return te(o,i,i+n.character)}function U(n){let e=[],t=!0;for(let i=0;i<n.length;i++){t&&(e.push(i),t=!1);let o=n.charAt(i);t=o==="\r"||o===`
`,o==="\r"&&i+1<n.length&&n.charAt(i+1)===`
`&&i++;}return t&&n.length>0&&e.push(n.length),e}function ie(n,e){return e.substring(O(n.start,e),O(n.end,e))}j$1();h();var J=class{constructor(){this.version=0;}getTextLength(){return this.getText().length}positionAt(e){return ne(e,this.getText(),this.getLineOffsets())}offsetAt(e){return O(e,this.getText(),this.getLineOffsets())}getLineOffsets(){return this.lineOffsets||(this.lineOffsets=U(this.getText())),this.lineOffsets}get uri(){return this.getURL()}get lineCount(){return this.getText().split(/\r?\n/).length}},R=class extends J{update(e,t,i){this.lineOffsets=void 0;let o=this.getText();this.setText(o.slice(0,t)+e+o.slice(i));}};F();j$1();h();var g=e(m$1(),1);function re(){let n=[];[[0,g.SemanticTokenModifiers.declaration],[1,g.SemanticTokenModifiers.static],[2,g.SemanticTokenModifiers.async],[3,g.SemanticTokenModifiers.readonly],[4,g.SemanticTokenModifiers.defaultLibrary],[5,"local"]].forEach(([t,i])=>n[t]=i);let e=[];return [[0,g.SemanticTokenTypes.class],[1,g.SemanticTokenTypes.enum],[2,g.SemanticTokenTypes.interface],[3,g.SemanticTokenTypes.namespace],[4,g.SemanticTokenTypes.typeParameter],[5,g.SemanticTokenTypes.type],[6,g.SemanticTokenTypes.parameter],[7,g.SemanticTokenTypes.variable],[8,g.SemanticTokenTypes.enumMember],[9,g.SemanticTokenTypes.property],[10,g.SemanticTokenTypes.function],[11,g.SemanticTokenTypes.method],[12,g.SemanticTokenTypes.event]].forEach(([t,i])=>e[t]=i),{tokenModifiers:n,tokenTypes:e}}j$1();h();function se(n,e,t){let i,o;return async c=>{e(c,o)&&clearTimeout(i),o=c,i=setTimeout(()=>{n(c),o=void 0;},t);}}function V(n,e){let t,i=Date.now()-e;function o(...c){clearTimeout(t),t=setTimeout(()=>{if(Date.now()-i<e){o(...c);return}n(...c),i=Date.now();},e);}return o}var le=e(k$1(),1);function ye(n){switch(n){case m$2.ScriptElementKind.primitiveType:case m$2.ScriptElementKind.keyword:return m.CompletionItemKind.Keyword;case m$2.ScriptElementKind.constElement:return m.CompletionItemKind.Constant;case m$2.ScriptElementKind.letElement:case m$2.ScriptElementKind.variableElement:case m$2.ScriptElementKind.localVariableElement:case m$2.ScriptElementKind.alias:return m.CompletionItemKind.Variable;case m$2.ScriptElementKind.memberVariableElement:case m$2.ScriptElementKind.memberGetAccessorElement:case m$2.ScriptElementKind.memberSetAccessorElement:return m.CompletionItemKind.Field;case m$2.ScriptElementKind.functionElement:return m.CompletionItemKind.Function;case m$2.ScriptElementKind.memberFunctionElement:case m$2.ScriptElementKind.constructSignatureElement:case m$2.ScriptElementKind.callSignatureElement:case m$2.ScriptElementKind.indexSignatureElement:return m.CompletionItemKind.Method;case m$2.ScriptElementKind.enumElement:return m.CompletionItemKind.Enum;case m$2.ScriptElementKind.moduleElement:case m$2.ScriptElementKind.externalModuleName:return m.CompletionItemKind.Module;case m$2.ScriptElementKind.classElement:case m$2.ScriptElementKind.typeElement:return m.CompletionItemKind.Class;case m$2.ScriptElementKind.interfaceElement:return m.CompletionItemKind.Interface;case m$2.ScriptElementKind.warning:case m$2.ScriptElementKind.scriptElement:return m.CompletionItemKind.File;case m$2.ScriptElementKind.directory:return m.CompletionItemKind.Folder;case m$2.ScriptElementKind.string:return m.CompletionItemKind.Constant}return m.CompletionItemKind.Property}function oe(n){return n?n.map(e=>e.text).join(""):""}function Ce(n){let e=`*@${n.name}*`;if(n.name==="param"&&n.text){let[t,...i]=n.text;e+=`\`${t.text}\``,i.length>0&&(e+=` \u2014 ${i.map(o=>o.text).join(" ")}`);}else Array.isArray(n.text)?e+=` \u2014 ${n.text.map(t=>t.text).join(" ")}`:n.text&&(e+=` \u2014 ${n.text}`);return e}function ce(n,e){let t=n.positionAt(e.start),i=n.positionAt(e.start+e.length);return {start:t,end:i}}var k=class extends R{constructor(t,i,o,c){super();this._uri=t;this.languageId=i;this.version=o;this.content=c;}get uri(){return n$1.parse(this._uri).toString(!0)}getFilePath(){return this.uri.replace("file:///","/")}getText(t){return t?ie(t,this.content):this.content}getURL(){return new URL(this.uri).toString()}setText(t){this.content=t;}},_="/",Te=p((n,e)=>{r(n,e);},50),j=class{constructor(e=100){this.limit=e;this._cache=new Map;}getKey(e){return e}tryGet(e){if(this._cache.has(this.getKey(e)))return this._cache.get(this.getKey(e))}set(e,t){return this._cache.size>this.limit&&this._cache.delete(this._cache.keys().next().value),this._cache.set(this.getKey(e),t),t}},$=class extends j{getKey(e,t){return `${e}:${t.line}:${t.character}`}constructor(e=100){super(e);}tryGet(e,t){if(this._cache.has(this.getKey(e,t)))return this._cache.get(this.getKey(e,t))}set(e,t,i){return this._cache.size>this.limit&&this._cache.delete(this._cache.keys().next().value),this._cache.set(this.getKey(e,t),i),i}};new $;var N=class{constructor(e,t,i){this.sendDiagnostics=e;this.docManager=t;this.getDiagnostics=i;this.pendingUpdates=new Set;this.scheduleUpdateAll=V(()=>this.updateAll(),1e3);this.scheduleBatchUpdate=V(()=>{this.pendingUpdates.forEach(e=>{this.update(e);});},1e3);}updateAll(){this.docManager.getDocuments().forEach(e=>{this.update(e);}),this.pendingUpdates.clear();}async update(e){let t=await this.getDiagnostics(e);this.sendDiagnostics({uri:e.uri,diagnostics:t});}removeDiagnostics(e){this.pendingUpdates.delete(e),this.sendDiagnostics({uri:e.uri,diagnostics:[]});}scheduleUpdate(e){this.docManager.getDocument(e.getURL())&&(this.pendingUpdates.add(e),this.scheduleBatchUpdate());}},ae=[".ts",".d.ts",".js",".mjs",".jsx",".tsx",".cjs",".mts",".cts"];var B=class{constructor(){this.emitter=new le.default.EventEmitter;this.documents=new Map;this.cancellableEmit=se(e=>{this.emitter.emit("documentChange",e);},(e,t)=>e?.uri===t?.uri,1e3);}getDocument(e){return this.documents.get(e)}getDocuments(){return Array.from(this.documents.values())}updateDocument(e,t){let i=this.documents.get(e.uri);if(!i)throw new Error("Cannot call methods on an unopened document");for(let o of t){let c=0,D=0;"range"in o?(c=i.offsetAt(o.range.start),D=i.offsetAt(o.range.end)):D=i.getTextLength(),i.update(o.text,c,D);}}openDocument(e,t,i,o){let c=new k(e,t,i,o);return this.documents.set(e,c),this.emitter.emit("documentOpen",c),c}scheduleUpdate(e){this.cancellableEmit(e);}closeDocument(e){let t=this.documents.get(e);t&&(this.documents.delete(e),this.emitter.emit("documentClose",t));}on(e,t){return this.emitter.on(e,t)}off(e,t){return this.emitter.off(e,t)}},ge=({connection:n})=>{let t=new B,i=new N(s=>{n.sendDiagnostics(s);},t,s=>pe(s));t.on("documentChange",i.scheduleUpdate.bind(i)),t.on("documentClose",i.removeDiagnostics.bind(i)),t.on("documentOpen",i.scheduleUpdate.bind(i));let c$1=(()=>{var s=new Map;let u=0;function d(a){var l=c.readFile(a,"utf-8");if(l)return m$2.ScriptSnapshot.fromString(l.toString())}let f=()=>m$2.parseJsonConfigFileContent(m$2.readConfigFile("/tsconfig.json",m$2.sys.readFile).config,m$2.sys,"/",{allowJs:!0,checkJs:!0,baseUrl:".",allowNonTsExtensions:!0,target:m$2.ScriptTarget.Latest,noEmit:!0,declaration:!1,skipLibCheck:!0},"/tsconfig.json"),E={...f().options,allowJs:!0,checkJs:!0,baseUrl:".",allowNonTsExtensions:!0,target:m$2.ScriptTarget.Latest,noEmit:!0,declaration:!1,skipLibCheck:!0},p=m$2.createCompilerHost(E);m$2.createModuleResolutionCache("/",p.getCanonicalFileName,E);let v={log:a=>console.debug(`[ts] ${a}`),getCompilationSettings:()=>f().options,getScriptFileNames(){return c.readDirectory("/",ae,["node_modules"])},getCompilerHost(){return p},writeFile:(a,l)=>{m$2.sys.writeFile(a,l,!1),c.writeFile(a,l);},realpath:g$1,getScriptVersion:function(l){return s.get(l)||"0"},getScriptSnapshot:d,getCurrentDirectory(){return _},getDefaultLibFileName:m$2.getDefaultLibFilePath,fileExists:c.fileExists.bind(c),readFile:(a,l)=>c.readFile(a,l).toString(),readDirectory(a,l,z,fe,Se){return c.readDirectory(a,l,z,fe,Se)},getDirectories:(...a)=>c.getDirectories(...a),useCaseSensitiveFileNames:()=>m$2.sys.useCaseSensitiveFileNames,getScriptKind:function(l){switch(l.split(".").pop().toLowerCase()){case m$2.Extension.Js:return m$2.ScriptKind.JS;case m$2.Extension.Jsx:return m$2.ScriptKind.JSX;case m$2.Extension.Ts:return m$2.ScriptKind.TS;case m$2.Extension.Tsx:return m$2.ScriptKind.TSX;case m$2.Extension.Json:return m$2.ScriptKind.JSON;default:return m$2.ScriptKind.Unknown}},getProjectVersion:()=>u.toString(),getNewLine:()=>m$2.sys.newLine};return {...m$2.createLanguageService(v),updateFile:function(a,l){s.set(a,(s.get(a)||0)+1),c.writeFile(a,l),m$2.sys.writeFile(a,l,!1),p.writeFile(a,l,!1),u++;},createFile:function(a,l){return Te(a,l),this.updateFile(a,l)}}})();s((s,u)=>{ae.some(d=>s.endsWith(d))?c$1.updateFile(h$1(s),u):c.writeFile(s,u);}),globalThis.localStorage=globalThis.localStorage??{},n.onInitialize(()=>({capabilities:{textDocumentSync:{openClose:!0,change:ue.TextDocumentSyncKind.Full,save:{includeText:!1}},completionProvider:{completionItem:{labelDetailsSupport:!0},triggerCharacters:[".",'"',"'","`","/","@","<",">","*","#","$","+","^","(","[","@","-",":","|"]},signatureHelpProvider:{triggerCharacters:["(",",","<"],retriggerCharacters:[")"]},semanticTokensProvider:{legend:re(),range:!0,full:!0},referencesProvider:!0,selectionRangeProvider:!0,hoverProvider:!0}}));async function P(s,u,d,f){let E=f.onCancellationRequested(()=>{throw null});try{let p=c$1.getCompletionsAtPosition(u,s,{includePackageJsonAutoImports:"on",includeCompletionsForImportStatements:!0,includeCompletionsForModuleExports:!0,triggerKind:d.context.triggerKind,includeCompletionsWithInsertText:!0,triggerCharacter:d.context.triggerCharacter,useLabelDetailsInCompletionEntries:!0,includeAutomaticOptionalChainCompletions:!0,includeCompletionsWithSnippetText:!0,includeCompletionsWithClassMemberSnippets:!0,includeCompletionsWithObjectLiteralMethodSnippets:!0});return !p||f.isCancellationRequested?null:{items:p.entries.filter(h=>h!=null).map(h=>({...h,label:h.name,kind:ye(h.kind)})),isIncomplete:p.isIncomplete}}catch{return null}finally{E.dispose();}}function de(s,u){return c$1.getQuickInfoAtPosition(u,s)}let pe=s=>{if(!c$1)return;let u=s.getFilePath(),d=c$1.getSyntacticDiagnostics(u),f=c$1.getSemanticDiagnostics(u),E=c$1.getSuggestionDiagnostics(u),p=h=>{if(typeof h=="string")return [h];let v=[],y=C=>{v.push(C.messageText),C.next&&C.next.forEach(a=>{y(a);});};return y(h),v};return [].concat(d,f,E).reduce((h,v)=>{let y=[m.DiagnosticSeverity.Warning,m.DiagnosticSeverity.Error,m.DiagnosticSeverity.Information,m.DiagnosticSeverity.Hint],C=p(v.messageText);for(let a of C)h.push({range:ce(s,v),message:a,source:v?.source||"ts",severity:y[v.category]});return h},[])};n.onDidOpenTextDocument(s=>{let u=h$1(s.textDocument.uri),d=s.textDocument.text,f=t.openDocument(s.textDocument.uri,s.textDocument.languageId,s.textDocument.version,d);_=x(u),c$1.createFile(u,d),t.scheduleUpdate(f);}),n.onDidChangeTextDocument(async s=>{let u=h$1(s.textDocument.uri),d=s.contentChanges[0].text,f=t.getDocument(s.textDocument.uri);t.updateDocument(s.textDocument,s.contentChanges),_!==x(u)&&(_=x(u)),c$1.createFile(u,d),t.scheduleUpdate(f);}),n.onCompletion(async(s,u)=>{let d=h$1(s.textDocument.uri),f=t.getDocument(s.textDocument.uri);return P(f.offsetAt(s.position),d,s,u)});let he=p(s=>{let{textDocument:u,position:d}=s,f=h$1(u.uri),E=t.getDocument(u.uri),p=de(E.offsetAt(d),f);if(!p)return;let M=oe(p.documentation),h=p.tags?p.tags.map(y=>Ce(y)).join(`  

`):"",v=oe(p.displayParts);return q({range:ce(E,p.textSpan),contents:[{language:"typescript",value:"```typescript\n"+v+"\n```\n"},{language:"typescript",value:M+(h?`

`+h:"")}]})},32);return n.onHover(he),n.listen(),()=>{n.dispose();}};var K=e(m$1(),1),me=globalThis,Fe=(0, K.createConnection)(new K.BrowserMessageReader(me),new K.BrowserMessageWriter(me)),yt=()=>t(ge,Fe,"TypeScript");

export { yt as TypeScriptWorker };
